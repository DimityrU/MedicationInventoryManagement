@model IEnumerable<MedicationInventoryManagement.Entities.Medication>;

@{
    ViewData["Title"] = "Medication Inventory";
}


<div class="position-fixed end-0">
    @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Error!</strong> @error.ErrorMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
    }
</div>

<h1 class="text-center mb-5">Medication Inventory</h1>
<a asp-controller="Home" asp-action="Create" class="btn btn-primary">Add new medication</a>



@if (@Model != null)
{
    <table class="table table-striped">
    <thead>
    <tr>
        <th>Medication Name</th>
        <th>Expiration Date</th>
        <th>Quantity</th>
        <th>Options</th>
    </tr>
    </thead>
    <tbody>
    @foreach (var medication in Model)
    {
        <tr>
            <td>@medication.MedicationName</td>
            <td>@medication.ExpirationDate.ToString("dd.MM.yyyy")</td>
            <td>@medication.Quantity</td>
            <td>
                    <a type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#modal-Remove-@medication.MedicationId">Remove</a>
                    <a type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#modal-Reduce-@medication.MedicationId">Reduce Quantity</a>
                @{
                    var removeMedication = new ModalData()
                    {
                        Id = medication.MedicationId,
                        MessageText = "Are you sure you want to remove this medication from the inventory?",
                        ButtonText = "Remove",
                        ButtonType = "danger",
                        ControllerName = "Home",
                        ActionName = "Delete"
                    };
                    var reduceQuantity = new ModalData()
                    {
                        Id = medication.MedicationId,
                        MessageText = "",
                        ButtonText = "Reduce",
                        ButtonType = "warning",
                        ControllerName = "Home",
                        ActionName = "Reduce",
                        Quantity = medication.Quantity
                    };
                }
            </td>
        </tr>
        @await Html.PartialAsync("_Modal", removeMedication)
        @await Html.PartialAsync("_Modal", reduceQuantity)
    }
    </tbody>
</table>
}
else
{
    <div class="position-fixed top-45 start-50 translate-middle">
        <div class="alert alert-warning" role="alert">
            <h3>No medication in System</h3>
        </div>
    </div>
}